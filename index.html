<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <title>Woodandmortar</title>
  <html lang="en" class="no-js"><head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <html class="no-js" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <META NAME="KEYWORDS" CONTENT="WoodandMortar LLC, WoodandMortar, Wood and Mortar, Bid Consultants, home improvement, home repair, house repair, house improvement, design, home design, designers, kitchen remodel, bathroom remodel, cement, stone, veneer, kitchen, bathroom, veneer stone, Painters, Painting, fireplace, tile, home repair, Contractors, Home, Home Renovations, Wood, wood&mortar, wood & mortar, brick, stucco, Wood and Mortar, WoodandMortar">
      <META NAME="ROBOTS" CONTENT="ALL,FOLLOW">
          <meta name="description" content="by Salmon">
          <meta name="viewport" content="width=device-width, initial-scale=1">
          <link rel="apple-touch-icon" sizes="180x180" href="pics/wm.png">
              <link rel="icon" type="image/png" href="pics/wm.png" sizes="32x32">
              <link rel="icon" type="image/png" href="pics/wm.png" sizes="16x16">
              <link rel="mask-icon" href="pics/wm.png" color="#fff">
              <link rel="shortcut icon" href="pics/wm.png">

      <link rel="stylesheet" href="css/style.css">

      <script src="https://apis.google.com/js/platform.js" async defer></script>
      <meta name="google-signin-client_id" content="930580119599-2j4jj0rjjdr7vkrurdsq5ecnsqm029tb.apps.googleusercontent.com">
      <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>

            <!-- Global site tag (gtag.js) - Google Analytics -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123535120-1"></script>
            <script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'UA-123535120-1');
            </script>

            <style>
            .salmonTail {
  transform: translateX(-3px);
  animation: kaboom 2s ease alternate infinite;
}
            @keyframes kaboom {
              0% {
                transform: translateX(0px);
              }
              50% {
                transform: translateX(-3px);
              }
              100% {
                transform: translateX(0px);
              }
            }
            </style>

</head>


<body>

<div class="carousel">
  <div class="carousel__nav">
   <span id="moveLeft" class="carousel__arrow">
        <svg class="carousel__icon" width="24" height="24" viewBox="0 0 24 24">
    <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path>
</svg>
    </span>
    <span id="moveRight" class="carousel__arrow" >
      <svg class="carousel__icon"  width="24" height="24" viewBox="0 0 24 24">
  <path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"></path>
</svg>
    </span>
  </div>
  <div class="carousel-item carousel-item--1">
    <div id="changeme" class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container">
        <div style="position:absolute; top:10px; left:30px; z-index:9999999999999999999999;">
            <svg class="salmonTail" width="80" height=80 viewBox="-359 -463 900 500">
              <path d="M3 49c0 6-2 11-5 15l-119 164c-6 8-20 15-30 15h-146c-7 0-11-3-11-8 0-2 1-5 3-7l130-179-130-179-3-7c0-5 4-8 11-8h146c10 0 24 7 30 15L-2 34c3 4 5 10 5 15z" fill="#D95952"></path>

            </svg>
        </div>
        <div style="position:absolute; top:10px; left:30px; z-index:9999999999999999999998;">
            <svg width="80" height=80 viewBox="-359 -463 900 500">
              <path d="M408 34L290-130c-6-8-20-15-30-15H16c-10 0-23 7-29 15l-33 45L40 34c3 4 5 10 5 15s-2 11-5 15l-86 119 33 45c6 8 19 15 29 15h244c10 0 24-7 30-15L408 64c3-4 5-10 5-15s-2-11-5-15zM206-90c12 0 21 9 21 21s-9 21-21 21-21-9-21-21 9-21 21-21z" fill="#D95952"></path>
            </svg>
        </div>
      <h2 class="carousel-item__subtitle">By Salmon</h2>
      <h1 class="carousel-item__title"><b>Wood&</b><br/>Mortar</h1>
      <p class="carousel-item__description">

<button id="buttonA" class="open-modal3" href="#" onClick="aboutScr()">About</button>

        <br><br><b><font size="4"><a style="text-decoration:none;color:#D95952;" href="mailto:woodmortar@gmail.com?&subject=Wood%20and%20Mortar&body=I%20have%20a%20quick%20question%20here%20is%20my%20email%20address%20and%20I%20am%20looking%20forward%20to%20speaking%20with%20you" >913.280.2336</a></font></b>
      <br><a style="color:black; text-decoration:none;" href="mailto:woodmortar@gmail.com?&subject=Wood%20and%20Mortar&body=I%20have%20a%20quick%20question%20here%20is%20my%20email%20address%20and%20I%20am%20looking%20forward%20to%20speaking%20with%20you">woodmortar@gmail.com</a></p>

<br>      <div class="g-signin2" data-onsuccess="onSignIn"></div><br>


        </div>
    </div>
  </div>

  <div class="carousel-item carousel-item--2">
    <div class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container"></div>
    </div>
  </div>

  <div class="carousel-item carousel-item--3">
    <div class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container"></div>
    </div>
  </div>

  <div class="carousel-item carousel-item--6">
    <div class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container"></div>
    </div>
  </div>

  <div class="carousel-item carousel-item--7">
    <div class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container"></div>
    </div>
  </div>

  <div class="carousel-item carousel-item--8">
    <div class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container"></div>
    </div>
  </div>

  <div class="carousel-item carousel-item--9">
    <div class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container"></div>
    </div>
  </div>

  <div class="carousel-item carousel-item--10">
    <div class="carousel-item__image"></div>
    <div class="carousel-item__info">
      <div class="carousel-item__container"></div>
    </div>
  </div>


</div>
</body>

<div style="display: none;" id="live-chat">

  <div id="item" class="chat" style="font-size:18px;">
        <div class="chat-message-content clearfix">
          <ul class="chatlist">
                <li class="bot__output bot__output--standard"><a id="foo4"><span class="bot__command">Woodandmortar LLC</span> was founded in April of 2018 by Micheal Salmon and is currently co-owned by Crycella Freitag.
                </a><br><br>
                  <button class="open-modal" href="#" onClick="compute1()">Contact Us</button>
                  <button class="open-modal1" href="#" onClick="compute()">Learn More</button>
                </li>
          </ul>




                <div class="chatbox-area" style="display: none;">
                  <form action="" id="chatform">
                      <textarea placeholder="Talk to me!" class="chatbox" name="chatbox" resize: "none" minlength="2"></textarea>
                      <input class="submit-button" type="submit" value="send"></input>
                  </form>
                </div>
            </div>
        </div>
</div>




  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <script src="js/index.js"></script>
    <script src="js/mechanics.js"></script>

    <script>


  var location;
  var project;
  var task;
  var fName;

  function onSignIn(googleUser) {

    var profile = googleUser.getBasicProfile();
    switch(profile.getEmail()){
      default:
          setTimeout(function(){window.location.href = 'https://woodandmortar.github.io/signup.html';}, 9000);
          break;
          case 'micheal.mfg@gmail.com':
              setTimeout(function(){window.location.href = 'https://woodandmortar.github.io/index2.html';}, 1200);
              break;
          case 'woodmortar@gmail.com':
          setTimeout(function(){window.location.href = 'https://woodandmortar.github.io/index2.html';}, 1200);
              break;
          case 'traviswindsor22@gmail.com':
          setTimeout(function(){window.location.href = 'https://woodandmortar.github.io/index2.html';}, 1200);
              break;
          case 'bigbawln@gmail.com':
          setTimeout(function(){window.location.href = 'https://woodandmortar.github.io/index2.html';}, 1200);
              break;


   }

  }

          function onSignInCallback(resp) {
            gapi.client.load('plus', 'v1', apiClientLoaded);
          }

          /**
           * Sets up an API call after the Google API client loads.
           */
          function apiClientLoaded() {
            gapi.client.plus.people.get({userId: 'me'}).execute(handleEmailResponse);
          }

            var sendForm = document.querySelector('#chatform'),
                textInput = document.querySelector('.chatbox'),
                chatList = document.querySelector('.chatlist'),
                userBubble = document.querySelectorAll('.userInput'),
                botBubble = document.querySelectorAll('.bot__output'),
                animateBotBubble = document.querySelectorAll('.bot__input--animation'),
                overview = document.querySelector('.chatbot__overview'),
                hasCorrectInput,
                imgLoader = false,
                animationCounter = 1,
                animationBubbleDelay = 600,
                input,
                previousInput,
                isReaction = false,
                unkwnCommReaction = "I don't understand, can you check your spelling please.",
                chatbotButton = document.querySelector(".submit-button")

            sendForm.onkeydown = function(e){
              if(e.keyCode == 13){
                e.preventDefault();

                //No mix ups with upper and lowercases
                var input = textInput.value.toLowerCase();

                //Empty textarea fix
                if(input.length > 0) {
                  createBubble(input)
                }
              }
            };

            sendForm.addEventListener('submit', function(e) {
              //so form doesnt submit page (no page refresh)
              e.preventDefault();

              //No mix ups with upper and lowercases
              var input = textInput.value.toLowerCase();

              //Empty textarea fix
              if(input.length > 0) {
                createBubble(input)
              }
            }) //end of eventlistener

            var createBubble = function(input) {
              //create input bubble
              var chatBubble = document.createElement('li');
              chatBubble.classList.add('userInput');

              //adds input of textarea to chatbubble list item
              chatBubble.innerHTML = input;

              //adds chatBubble to chatlist
              chatList.appendChild(chatBubble)

              checkInput(input);
            }

            var checkInput = function(input) {
              hasCorrectInput = false;
              isReaction = false;
              //Checks all text values in possibleInput
              for(var textVal in possibleInput){
                //If user reacts with "yes" and the previous input was in textVal
                if(input == "yes" || input.indexOf("yes") >= 0){
                  if(previousInput == textVal) {
                    console.log("sausigheid");

                    isReaction = true;
                    hasCorrectInput = true;
                    botResponse(textVal);
                  }
                }
                if(input == "no" && previousInput == textVal){
                  unkwnCommReaction = "For a list of commands type: Commands";
                  unknownCommand("I'm sorry to hear that :(")
                  unknownCommand(unkwnCommReaction);
                  hasCorrectInput = true;
                }
                //Is a word of the input also in possibleInput object?
                if(input == textVal || input.indexOf(textVal) >=0 && isReaction == false){
            			console.log("succes");
                  hasCorrectInput = true;
                  botResponse(textVal);
            		}
            	}
              //When input is not in possibleInput
              if(hasCorrectInput == false){
                console.log("failed");
                unknownCommand(unkwnCommReaction);
                hasCorrectInput = true;
              }
            }

            // debugger;

            function botResponse(textVal) {
              //sets previous input to that what was called
              // previousInput = input;

              //create response bubble
              var userBubble = document.createElement('li');
              userBubble.classList.add('bot__output');

              if(isReaction == true){
                if (typeof reactionInput[textVal] === "function") {
                //adds input of textarea to chatbubble list item
                  userBubble.innerHTML = reactionInput[textVal]();
                } else {
                  userBubble.innerHTML = reactionInput[textVal];
                }
              }

              if(isReaction == false){
                //Is the command a function?
                if (typeof possibleInput[textVal] === "function") {
                  // console.log(possibleInput[textVal] +" is a function");
                //adds input of textarea to chatbubble list item
                  userBubble.innerHTML = possibleInput[textVal]();
                } else {
                  userBubble.innerHTML = possibleInput[textVal];
                }
              }
              //add list item to chatlist
              chatList.appendChild(userBubble) //adds chatBubble to chatlist

              // reset text area input
              textInput.value = "";
            }

            function unknownCommand(unkwnCommReaction) {
              // animationCounter = 1;

              //create response bubble
              var failedResponse = document.createElement('li');

              failedResponse.classList.add('bot__output');
              failedResponse.classList.add('bot__output--failed');

              //Add text to failedResponse
              failedResponse.innerHTML = unkwnCommReaction; //adds input of textarea to chatbubble list item

              //add list item to chatlist
              chatList.appendChild(failedResponse) //adds chatBubble to chatlist

              animateBotOutput();

              // reset text area input
              textInput.value = "";

              //Sets chatlist scroll to bottom
              chatList.scrollTop = chatList.scrollHeight;

              animationCounter = 1;
            }

            function responseText(e) {

              var response = document.createElement('li');

              response.classList.add('bot__output');

              //Adds whatever is given to responseText() to response bubble
              response.innerHTML = e;

              chatList.appendChild(response);

              animateBotOutput();

              console.log(response.clientHeight);

              //Sets chatlist scroll to bottom
              setTimeout(function(){
                chatList.scrollTop = chatList.scrollHeight;
                console.log(response.clientHeight);
              }, 0)
            }

            function responseImg(e) {
              var image = new Image();

              image.classList.add('bot__output');
              //Custom class for styling
              image.classList.add('bot__outputImage');
              //Gets the image
              image.src = "./"+e;
              chatList.appendChild(image);

              animateBotOutput()
              if(image.completed) {
                chatList.scrollTop = chatList.scrollTop + image.scrollHeight;
              }
              else {
                image.addEventListener('load', function(){
                  chatList.scrollTop = chatList.scrollTop + image.scrollHeight;
                })
              }
            }

            //change to SCSS loop
            function animateBotOutput() {
              chatList.lastElementChild.style.animationDelay= (animationCounter * animationBubbleDelay)+"ms";
              animationCounter++;
              chatList.lastElementChild.style.animationPlayState = "running";
            }

            function commandReset(e){
              animationCounter = 1;
              previousInput = Object.keys(possibleInput)[e];
            }

            // hlep

            var possibleInput = {
              // "hlep" : this.help(),
              "help" : function(){
                responseText("try trying something like... show BEST WORK")
                responseText("Typing COMMANDS will always bring up the main list.")
                commandReset(0);
                return
                },
              "best work" : function(){
                responseText("I will show you our best work!");
                responseImg("scrImage2.jpg");
                responseImg("scrImage3.jpg");
                responseImg("scrImage4.jpg");
                responseText("Would you like to see more? (Yes/No)")
                commandReset(1);
                return
                },
              "about" : function(){
                responseText("Salmon here, your digital assistant for everything WoodandMortar.");
                responseText("I'm also a Salmon.fund expert.");
                responseText("Using your google account, I'll be able to remember you.");
                responseText("Would you like to connect? (Yes/No)");
                commandReset(2);
                return
                },
              "experience" : function(){
                responseText("We've completed 21 High-end to Flip Kitchens in the past 8 months");
                responseText("We sub-contract 75% of our work load, to Kansas City non-profits through our mentorship platform.");
                responseText("Micheal Salmon, Founder and Co-Owner pays special attention to project details and workflow ensuring the best possible value.");
                responseText("Crycella Freitag, Co-Owner and human resource powerhouse manages all aspects of communication, logistics and finance.");
                responseText("Would you like to see our Business Process Manual? (Yes/No)");
                commandReset(3);
                return
              },
              "specials" : function(){
                responseText("Spring means decks, patios, and landscaping");
                responseText("We're ordering our lumber for summer projects, so all appointments made before june 29th get all lumber AT COST.");
                responseText("$6000 Two-Story decks");
                responseText("$4000 /room Water Damage Reframe");
                responseText("$2500 Emperor's Tree House");
                commandReset(4);
                return
              },
              "theme" : function(){
                responseText("Our 2019 aesthetic begin with:");
                responseText("Chic Grey Walls");
                responseText("Satin Ultra-White Trim");
                responseText("Midnight Horse Black Front Door");
                responseText("Forest Green, Faded Two-Tone Exterior");
                commandReset(5);
                return
              },
              "vision" : function(){
                responseText("We are aiming for completing WoodandMortar.edu by 2022");
                responseText("By training locals in specialized trades,");
                responseText("we are giving equal oppourtunity for high yield local property investments and ownership.");
                responseText("Our tradespeople will be the backbone for Kansas City remodeling.");
                commandReset(6);
                return
              },
              "contact" : function(){
                responseText("email: <a href='mailto:micheal.mfg@gmail.com?Subject=Hello%20Micheal' target='_top'>send me a message</a>");
                commandReset(7);
                return
              },
              "Salmon" : function(){
                responseText("UmmmmmHmmmmmm.... Yes?");
                commandReset(8);
                return
              },
              "commands" : function(){
                responseText("about, best work, contact, mcred <br> specials, theme, experience, vision");
                commandReset(9);
                return
              },
              "mcred" : function(){
                responseText("<a href='https://drive.google.com/open?id=10lbMd2b0YuqKF9mq5D9gMK6g58yQ849lJ2_LwJ3QpRI' target='_blank'>Safety Training</a> <br>  <a href='https://drive.google.com/open?id=1aovEiosNLQ2Bv09UtQuf15Pxf28PXco4ogT02ryoF1w' target='_blank'>Safety Practices</a> <br> <a href='https://drive.google.com/open?id=1OLezOcO7mLV8Jc0Mp6sy9o4HodRoHZlT67xecsrpbTM' style='color:red;' target='_blank'>Safety TEST</a>");
                responseText("<a href='https://drive.google.com/open?id=1sIbw07cA7386r0BX2-nRuf5_6BO8obgt4868zk1MMvU' target='_blank'>Drywall & Texture Study Guide</a> <br>  <a href='https://drive.google.com/open?id=1mfcnDzY4__0RGBMBmOoUm3KWVUxoXyYwWuwHNY7M788' style='color:red;' target='_blank'>Drywall & Texture TEST</a> ");
                responseText("<a href='https://drive.google.com/open?id=1ywAJ7PvYA3WsdG1ninCW0S8H18etPnLJ_asRghmqP9I' target='_blank'>Painting Study Guide</a> <br>  <a href='https://drive.google.com/open?id=1mKbNJ-wTZ9MlJrOtLc1Ei4C0f08HrpTnUIPmk2l_25I' style='color:red;' target='_blank'>Painting TEST</a> ");
                responseText("<a href='https://drive.google.com/open?id=16vgbiM7Y6I2D4UYYffhL44UDrJ1iHVMNTo7DJ7uQTCE' target='_blank'>Tile Study Guide</a> <br>  <a href='https://drive.google.com/open?id=1fUV4WDuQJfwW7cukP1aoeFlR0ZgY1MVK3IWeqdO4jH4' style='color:red;' target='_blank'>Tile TEST</a> ");
                commandReset(13);
                return
              },

            }

            var reactionInput = {
              "best work" : function(){
                responseText("<a href='https://www.facebook.com/woodmortar/' target='_blank'>Click here to open our Facebook</a>")
                responseText("On this GitHub page you'll find everything about Salmon");
                responseText("<a href='https://github.com/woodandmortar' target='_blank'>WoodandMortar on GitHub</a>")
                animationCounter = 1;
                return
              },
              "about" : function(){
                responseText("I'll need to use GMAIL as your contact point.");
                setTimeout(function(){
                  window.location.href = "mailto:info@woodandmortar.com?Subject=Hello%20again&body=If%20GMAIL%20didnt%20open%20please%20send%20a%20gmail%20message%20to%20my%20sender%20address"; }, 4000);
                  animationCounter = 1;
                return
                },
              "experience" : function(){
                responseText("I will redirect you a printable Business Process Manual");
                setTimeout(function(){
                  window.location.href = "https://docs.google.com/document/d/1OAgXxoruvHMqD7lyAqu0m1Bq082rXp7g2Z1wcc-vZnY/edit?usp=sharing"; }, 6000);
                animationCounter = 1;
                return
              }
            }




                      (function() {
                        'use strict';

                        var inNodeJS = typeof process !== 'undefined' && !process.browser;

                        var request = function requestNotProvided() {
                          throw new Error("The 'request' module is only available while running in Node.");
                        };
                        if(inNodeJS) { // This will get stripped out by Uglify, and Webpack will not include it
                          request = require('request');
                        }

                        var supportsCORS = false;
                        var inLegacyIE = false;
                        try {
                          var testXHR = new XMLHttpRequest();
                          if (typeof testXHR.withCredentials !== 'undefined') {
                            supportsCORS = true;
                          } else {
                            if ('XDomainRequest' in window) {
                              supportsCORS = true;
                              inLegacyIE = true;
                            }
                          }
                        } catch (e) { }

                        // Create a simple indexOf function for support
                        // of older browsers.  Uses native indexOf if
                        // available.  Code similar to underscores.
                        // By making a separate function, instead of adding
                        // to the prototype, we will not break bad for loops
                        // in older browsers
                        var indexOfProto = Array.prototype.indexOf;
                        var ttIndexOf = function(array, item) {
                          var i = 0, l = array.length;

                          if (indexOfProto && array.indexOf === indexOfProto) {
                            return array.indexOf(item);
                          }

                          for (; i < l; i++) {
                            if (array[i] === item) {
                              return i;
                            }
                          }
                          return -1;
                        };

                        /*
                          Initialize with Tabletop.init( { key: '0AjAPaAU9MeLFdHUxTlJiVVRYNGRJQnRmSnQwTlpoUXc' } )
                            OR!
                          Initialize with Tabletop.init( { key: 'https://docs.google.com/spreadsheet/pub?hl=en_US&hl=en_US&key=0AjAPaAU9MeLFdHUxTlJiVVRYNGRJQnRmSnQwTlpoUXc&output=html&widget=true' } )
                            OR!
                          Initialize with Tabletop.init('0AjAPaAU9MeLFdHUxTlJiVVRYNGRJQnRmSnQwTlpoUXc')
                        */

                        var Tabletop = function(options) {
                          // Make sure Tabletop is being used as a constructor no matter what.
                          if(!this || !(this instanceof Tabletop)) {
                            return new Tabletop(options);
                          }

                          if(typeof(options) === 'string') {
                            options = { key : options };
                          }

                          this.callback = options.callback;
                          this.error = options.error;
                          this.wanted = options.wanted || [];
                          this.key = options.key;
                          this.simpleSheet = !!options.simpleSheet;
                          this.parseNumbers = !!options.parseNumbers;
                          this.wait = !!options.wait;
                          this.reverse = !!options.reverse;
                          this.postProcess = options.postProcess;
                          this.debug = !!options.debug;
                          this.query = options.query || '';
                          this.orderby = options.orderby;
                          this.endpoint = options.endpoint || 'https://spreadsheets.google.com';
                          this.singleton = !!options.singleton;
                          this.simpleUrl = !!(options.simpleUrl || options.simple_url); //jshint ignore:line
                          this.authkey = options.authkey;
                          this.sheetPrivacy = this.authkey ? 'private' : 'public'

                          this.callbackContext = options.callbackContext;
                          // Default to on, unless there's a proxy, in which case it's default off
                          this.prettyColumnNames = typeof(options.prettyColumnNames) === 'undefined' ? !options.proxy : options.prettyColumnNames;

                          if(typeof(options.proxy) !== 'undefined') {
                            // Remove trailing slash, it will break the app
                            this.endpoint = options.proxy.replace(/\/$/,'');
                            this.simpleUrl = true;
                            this.singleton = true;
                            // Let's only use CORS (straight JSON request) when
                            // fetching straight from Google
                            supportsCORS = false;
                          }

                          this.parameterize = options.parameterize || false;

                          if (this.singleton) {
                            if (typeof(Tabletop.singleton) !== 'undefined') {
                              this.log('WARNING! Tabletop singleton already defined');
                            }
                            Tabletop.singleton = this;
                          }

                          /* Be friendly about what you accept */
                          if (/key=/.test(this.key)) {
                            this.log('You passed an old Google Docs url as the key! Attempting to parse.');
                            this.key = this.key.match('key=(.*?)(&|#|$)')[1];
                          }

                          if (/pubhtml/.test(this.key)) {
                            this.log('You passed a new Google Spreadsheets url as the key! Attempting to parse.');
                            this.key = this.key.match('d\\/(.*?)\\/pubhtml')[1];
                          }

                          if(/spreadsheets\/d/.test(this.key)) {
                            this.log('You passed the most recent version of Google Spreadsheets url as the key! Attempting to parse.');
                            this.key = this.key.match('d\\/(.*?)\/')[1];
                          }

                          if (!this.key) {
                            this.log('You need to pass Tabletop a key!');
                            return;
                          }

                          this.log('Initializing with key ' + this.key);

                          this.models = {};
                          this.modelNames = [];
                          this.model_names = this.modelNames; //jshint ignore:line

                          this.baseJsonPath = '/feeds/worksheets/' + this.key + '/' + this.sheetPrivacy +'/basic?alt=';

                          if (inNodeJS || supportsCORS) {
                            this.baseJsonPath += 'json';
                          } else {
                            this.baseJsonPath += 'json-in-script';
                          }

                          if (this.authkey) {
                            this.baseJsonPath += '&oauth_token=' + this.authkey;
                          }

                          if(!this.wait) {
                            return this.fetch();
                          }
                        };

                        // A global storage for callbacks.
                        Tabletop.callbacks = {};

                        // Backwards compatibility.
                        Tabletop.init = function(options) {
                          return new Tabletop(options);
                        };

                        Tabletop.sheets = function() {
                          this.log('Times have changed! You\'ll want to use var tabletop = Tabletop.init(...); tabletop.sheets(...); instead of Tabletop.sheets(...)');
                        };

                        Tabletop.prototype = {

                          fetch: function(callback) {
                            var self = this;
                            return new Promise(function(resolve, reject) {
                              if (typeof(callback) !== 'undefined') {
                                self.callback = callback;
                              }
                              if (!self.callback) {
                                self.callback = resolve;
                              }
                              if (!self.error) {
                                self.error = reject;
                              }
                              self.requestData(self.baseJsonPath, self.loadSheets);
                            });
                          },

                          /*
                            This will call the environment appropriate request method.

                            In browser it will use JSON-P, in node it will use request()
                          */
                          requestData: function(path, callback) {
                            this.log('Requesting', path);
                            this.encounteredError = false;
                            if (inNodeJS) {
                              this.serverSideFetch(path, callback);
                            } else {
                              //CORS only works in IE8/9 across the same protocol
                              //You must have your server on HTTPS to talk to Google, or it'll fall back on injection
                              var protocol = this.endpoint.split('//').shift() || 'http';
                              if (supportsCORS && (!inLegacyIE || protocol === location.protocol)) {
                                this.xhrFetch(path, callback);
                              } else {
                                this.injectScript(path, callback);
                              }
                            }
                          },

                          /*
                            Use Cross-Origin XMLHttpRequest to get the data in browsers that support it.
                          */
                          xhrFetch: function(path, callback) {
                            //support IE8's separate cross-domain object
                            var xhr = inLegacyIE ? new XDomainRequest() : new XMLHttpRequest();
                            xhr.open('GET', this.endpoint + path);
                            var self = this;
                            xhr.onload = function() {
                              var json;
                              try {
                                json = JSON.parse(xhr.responseText);
                              } catch (e) {
                                console.error(e);
                              }
                              callback.call(self, json);
                            };
                            if(this.error) {
                              xhr.addEventListener('error', this.error);
                            }
                            xhr.send();
                          },

                          injectScript: function(path, callback) {
                            var script = document.createElement('script');
                            var callbackName;

                            if (this.singleton) {
                              if (callback === this.loadSheets) {
                                callbackName = 'Tabletop.singleton.loadSheets';
                              } else if (callback === this.loadSheet) {
                                callbackName = 'Tabletop.singleton.loadSheet';
                              }
                            } else {
                              var self = this;
                              callbackName = 'tt' + (+new Date()) + (Math.floor(Math.random()*100000));
                              Tabletop.callbacks[ callbackName ] = function () {
                                var args = Array.prototype.slice.call( arguments, 0 );
                                callback.apply(self, args);
                                script.parentNode.removeChild(script);
                                delete Tabletop.callbacks[callbackName];
                              };
                              callbackName = 'Tabletop.callbacks.' + callbackName;
                            }

                            var url = path + '&callback=' + callbackName;

                            if (this.simpleUrl) {
                              if(path.indexOf('/list/') !== -1) {
                                script.src = this.endpoint + '/' + this.key + '-' + path.split('/')[4];
                              } else {
                                script.src = this.endpoint + '/' + this.key;
                              }
                            } else {
                              script.src = this.endpoint + url;
                            }

                            if (this.parameterize) {
                              script.src = this.parameterize + encodeURIComponent(script.src);
                            }

                            this.log('Injecting', script.src);

                            document.getElementsByTagName('script')[0].parentNode.appendChild(script);
                          },
                          serverSideFetch: function(path, callback) {
                            var self = this;

                            this.log('Fetching', this.endpoint + path);
                            request({url: this.endpoint + path, json: true}, function(err, resp, body) {
                              if (err) {
                                return console.error(err);
                              }
                              callback.call(self, body);
                            });
                          },
                          isWanted: function(sheetName) {
                            if (this.wanted.length === 0) {
                              return true;
                            } else {
                              return (ttIndexOf(this.wanted, sheetName) !== -1);
                            }
                          },
                          data: function() {
                            if (this.modelNames.length === 0) {
                              return undefined;
                            }
                            if (this.simpleSheet) {
                              if (this.modelNames.length > 1 && this.debug) {
                                this.log('WARNING You have more than one sheet but are using simple sheet mode! Don\'t blame me when something goes wrong.');
                              }
                              return this.models[this.modelNames[0]].all();
                            } else {
                              return this.models;
                            }
                          },
                          addWanted: function(sheet) {
                            if(ttIndexOf(this.wanted, sheet) === -1) {
                              this.wanted.push(sheet);
                            }
                          },
                          loadSheets: function(data) {
                            var i, ilen;
                            var toLoad = [];
                            try {
                              this.googleSheetName = data.feed.title.$t;
                            } catch(err) {
                              this.error(err);
                              return;
                            }
                            this.foundSheetNames = [];

                            for (i = 0, ilen = data.feed.entry.length; i < ilen ; i++) {
                              this.foundSheetNames.push(data.feed.entry[i].title.$t);
                              if (this.isWanted(data.feed.entry[i].content.$t)) {
                                var linkIdx = data.feed.entry[i].link.length-1;
                                var sheetId = data.feed.entry[i].link[linkIdx].href.split('/').pop();
                                var jsonPath = '/feeds/list/' + this.key + '/' + sheetId + '/' + this.sheetPrivacy + '/values?alt=';
                                if (inNodeJS || supportsCORS) {
                                  jsonPath += 'json';
                                } else {
                                  jsonPath += 'json-in-script';
                                }
                                if (this.query) {
                                  jsonPath += '&tq=' + this.query;
                                }
                                if (this.orderby) {
                                  jsonPath += '&orderby=column:' + this.orderby.toLowerCase();
                                }
                                if (this.reverse) {
                                  jsonPath += '&reverse=true';
                                }
                                if (this.authkey) {
                                  jsonPath += '&oauth_token=' + this.authkey;
                                }
                                toLoad.push(jsonPath);
                              }
                            }

                            this.sheetsToLoad = toLoad.length;
                            for(i = 0, ilen = toLoad.length; i < ilen; i++) {
                              this.requestData(toLoad[i], this.loadSheet);
                            }
                          },
                          sheets: function(sheetName) {
                            if (typeof sheetName === 'undefined') {
                              return this.models;
                            } else {
                              if (typeof(this.models[sheetName]) === 'undefined') {
                                return;
                              } else {
                                return this.models[sheetName];
                              }
                            }
                          },

                          sheetReady: function(model) {
                            this.models[model.name] = model;
                            if (ttIndexOf(this.modelNames, model.name) === -1) {
                              this.modelNames.push(model.name);
                            }

                            this.sheetsToLoad--;
                            if (this.sheetsToLoad === 0) {
                              this.doCallback();
                            }
                          },
                          loadSheet: function(data) {
                            var that = this;
                            new Tabletop.Model({
                              data: data,
                              parseNumbers: this.parseNumbers,
                              postProcess: this.postProcess,
                              tabletop: this,
                              prettyColumnNames: this.prettyColumnNames,
                              onReady: function() {
                                that.sheetReady(this);
                              }
                            });
                          },
                          doCallback: function() {
                            if(this.sheetsToLoad === 0) {
                              this.callback.apply(this.callbackContext || this, [this.data(), this]);
                            }
                          },

                          log: function() {
                            if(this.debug) {
                              if(typeof console !== 'undefined' && typeof console.log !== 'undefined') {
                                Function.prototype.apply.apply(console.log, [console, arguments]);
                              }
                            }
                          }

                        };
                        Tabletop.Model = function(options) {
                          var i, j, ilen, jlen;
                          this.columnNames = [];
                          this.column_names = this.columnNames;
                          this.name = options.data.feed.title.$t;
                          this.tabletop = options.tabletop;
                          this.elements = [];
                          this.onReady = options.onReady;
                          this.raw = options.data;

                          if (typeof(options.data.feed.entry) === 'undefined') {
                            options.tabletop.log('Missing data for ' + this.name + ', make sure you didn\'t forget column headers');
                            this.originalColumns = [];
                            this.elements = [];
                            this.ready();
                            return;
                          }

                          for (var key in options.data.feed.entry[0]){
                            if (/^gsx/.test(key)) {
                              this.columnNames.push(key.replace('gsx$',''));
                            }
                          }

                          this.originalColumns = this.columnNames;
                          this.original_columns = this.originalColumns;

                          for (i = 0, ilen =  options.data.feed.entry.length ; i < ilen; i++) {
                            var source = options.data.feed.entry[i];
                            var element = {};
                            for (j = 0, jlen = this.columnNames.length; j < jlen ; j++) {
                              var cell = source['gsx$' + this.columnNames[j]];
                              if (typeof(cell) !== 'undefined') {
                                if (options.parseNumbers && cell.$t !== '' && !isNaN(cell.$t)) {
                                  element[this.columnNames[j]] = +cell.$t;
                                } else {
                                  element[this.columnNames[j]] = cell.$t;
                                }
                              } else {
                                element[this.columnNames[j]] = '';
                              }
                            }
                            if (element.rowNumber === undefined) {
                              element.rowNumber = i + 1;
                            }

                            this.elements.push(element);
                          }

                          if (options.prettyColumnNames) {
                            this.fetchPrettyColumns();
                          } else {
                            this.ready();
                          }
                        };

                        Tabletop.Model.prototype = {
                          all: function() {
                            return this.elements;
                          },

                          fetchPrettyColumns: function() {
                            if (!this.raw.feed.link[3]) {
                              return this.ready();
                            }

                            var cellurl = this.raw.feed.link[3].href.replace('/feeds/list/', '/feeds/cells/').replace('https://spreadsheets.google.com', '');
                            var that = this;
                            this.tabletop.requestData(cellurl, function(data) {
                              that.loadPrettyColumns(data);
                            });
                          },

                          beforeReady: function() {
                            if(this.postProcess) {
                              for (i = 0, ilen = this.elements.length; i < ilen; i++) {
                                this.postProcess(element);
                              }
                            }
                          },

                          ready: function() {
                            this.beforeReady();
                            this.onReady.call(this);
                          },
                          loadPrettyColumns: function(data) {
                            var prettyColumns = {};

                            var columnNames = this.columnNames;

                            var i = 0;
                            var l = columnNames.length;

                            for (; i < l; i++) {
                              if (typeof data.feed.entry[i].content.$t !== 'undefined') {
                                prettyColumns[columnNames[i]] = data.feed.entry[i].content.$t;
                              } else {
                                prettyColumns[columnNames[i]] = columnNames[i];
                              }
                            }

                            this.prettyColumns = prettyColumns;
                            this.pretty_columns = this.prettyColumns; // jshint ignore:line
                            this.prettifyElements();
                            this.ready();
                          },
                          prettifyElements: function() {
                            var prettyElements = [],
                                orderedPrettyNames = [],
                                i, j, ilen, jlen;

                            for (j = 0, jlen = this.columnNames.length; j < jlen ; j++) {
                              orderedPrettyNames.push(this.prettyColumns[this.columnNames[j]]);
                            }

                            for (i = 0, ilen = this.elements.length; i < ilen; i++) {
                              var newElement = {};
                              for (j = 0, jlen = this.columnNames.length; j < jlen ; j++) {
                                var newColumnName = this.prettyColumns[this.columnNames[j]];
                                newElement[newColumnName] = this.elements[i][this.columnNames[j]];
                              }
                              prettyElements.push(newElement);
                            }
                            this.elements = prettyElements;
                            this.columnNames = orderedPrettyNames;
                          },
                          toArray: function() {
                            var array = [],
                                i, j, ilen, jlen;
                            for (i = 0, ilen = this.elements.length; i < ilen; i++) {
                              var row = [];
                              for (j = 0, jlen = this.columnNames.length; j < jlen ; j++) {
                                row.push(this.elements[i][ this.columnNames[j]]);
                              }
                              array.push(row);
                            }

                            return array;
                          }
                        };

                        if(typeof module !== 'undefined' && module.exports) {
                          module.exports = Tabletop;
                        } else if (typeof define === 'function' && define.amd) {
                          define(function () {
                            return Tabletop;
                          });
                        } else {
                          window.Tabletop = Tabletop;
                        }

                      })();

                      </script>




                      <script type="text/javascript">
                        mNum = -1;

                        var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1kTFnCiuDAYVdpzNqVIgNKsSLKYK9tRR1Mxd6gjBncFU/pub?hl=en_US&hl=en_US&hl=en_US&output=html';

                        function init() {
                                Tabletop.init( { key: public_spreadsheet_url,
                                                 callback: showInfo,
                                                 simpleSheet: true } );
                              }

                              window.addEventListener('DOMContentLoaded', init)

                              function showInfo(data) {
                                var mNum = Math.floor((Math.random() * 42) + 1);
                                mProb = data[mNum].Name;
                                answerA = data[mNum].AnswerA;
                                answerB = data[mNum].AnswerB;
                                answerC = data[mNum].AnswerC;
                                answerD = data[mNum].AnswerD;
                                solution = data[mNum].Solution;
                                studyGuide = data[mNum].Link;
                                metadata = data[mNum].MetaData;
                                document.getElementById("slotA").innerHTML = [ answerA ].join(", ");
                                document.getElementById("slotB").innerHTML = [ answerB ].join(", ");
                                document.getElementById("slotC").innerHTML = [ answerC ].join(", ");
                                document.getElementById("slotD").innerHTML = [ answerD ].join(", ");
                                document.getElementById("metaData").innerHTML = [ metadata ].join(", ");
                                document.getElementById("solution1").innerHTML = [ solution ].join(", ");
                                document.getElementById("theStudyGuide").innerHTML = [ studyGuide ].join(", ");
                                document.getElementById("math").innerHTML = [ mProb ].join(", ");
                                console.log(data);
                              }

                        </script>

</body>

</html>
